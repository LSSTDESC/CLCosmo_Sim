****************************************************************
*                      SLURM Batch System                      *
*           IN2P3 Computing Centre, Villeurbanne FR            *
****************************************************************
* Date:                 Fri Mar 22 16:53:29 CET 2024
* Job name:             extract_cosmodc2_redmapper
* Job id:               4817011
* User:                 cpayerne
* Account:              lsst
* Submit host:          jns-cpayerne.cc.in2p3.fr
* Partition:            htc
* Quality of service:   normal
* Nodelist:             ccwslurm0331
****************************************************************
/pbs/throng/lsst/users/cpayerne/CLCosmo_Sim/extract_DC2_data/_utils_extract_sources_in_cosmoDC2.py:104: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  tab = pd.read_sql_query(query_mysql, conn_qserv)
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/throng/lsst/users/cpayerne/CLCosmo_Sim/extract_DC2_data/_utils_photometric_redshifts.py:65: RuntimeWarning: divide by zero encountered in reciprocal
  return simps(sigmacrit_1_integrand, pzbins[0,:], axis=1)**(-1.)
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/throng/lsst/users/cpayerne/CLCosmo_Sim/extract_DC2_data/_utils_photometric_redshifts.py:65: RuntimeWarning: divide by zero encountered in reciprocal
  return simps(sigmacrit_1_integrand, pzbins[0,:], axis=1)**(-1.)
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/throng/lsst/users/cpayerne/CLCosmo_Sim/extract_DC2_data/_utils_photometric_redshifts.py:65: RuntimeWarning: divide by zero encountered in reciprocal
  return simps(sigmacrit_1_integrand, pzbins[0,:], axis=1)**(-1.)
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/throng/lsst/users/cpayerne/CLCosmo_Sim/extract_DC2_data/_utils_photometric_redshifts.py:65: RuntimeWarning: divide by zero encountered in reciprocal
  return simps(sigmacrit_1_integrand, pzbins[0,:], axis=1)**(-1.)
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/throng/lsst/users/cpayerne/CLCosmo_Sim/extract_DC2_data/_utils_photometric_redshifts.py:65: RuntimeWarning: divide by zero encountered in reciprocal
  return simps(sigmacrit_1_integrand, pzbins[0,:], axis=1)**(-1.)
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
/pbs/home/c/cpayerne/.conda/envs/myenv/lib/python3.10/site-packages/clmm-1.10.0-py3.10.egg/clmm/cosmology/parent_class.py:454: UserWarning: 
Some source redshifts are lower than the cluster redshift.
Sigma_crit = np.inf for those galaxies.
['DSt_true', 'DSx_true', 'W_l_true', 'radius_true', 'DSt_flex', 'DSx_flex', 'W_l_flex', 'radius_flex', 'DSt_bpz', 'DSx_bpz', 'W_l_bpz', 'radius_bpz']
====> cluster nÂ°10, at redshift z = 0.51 and distance DA = 1274.34 Mpc
====> name for save: /sps/lsst/users/cpayerne/CLMassDC2/cosmoDC2/redmapper_clusters_new/lensing_catalog_halo_10.pkl
==> extracting true redshift + shapes infos (Qserv)
==> Qserv: Number of extracted galaxies = 50516
==> extracting photoz redshift infos (GCRCatalogs)
==> healpix pixels covered (nside: 32): dec 
----
8787
----> extraction in cosmoDC2_v1.1.4_image_with_photozs_v1
-----> heapix pixel = 8787
chunk = 0
number of galaxies in the full healpix = 818617
number of galaxies tageted in the healpix = 35693
chunk = 1
number of galaxies in the full healpix = 599512
number of galaxies tageted in the healpix = 13917
chunk = 2
number of galaxies in the full healpix = 148758
number of galaxies tageted in the healpix = 906
50516
----> extraction in cosmoDC2_v1.1.4_image_with_photozs_v1
-----> heapix pixel = 8787
chunk = 0
number of galaxies in the full healpix = 818617
number of galaxies tageted in the healpix = 35693
chunk = 1
number of galaxies in the full healpix = 599512
number of galaxies tageted in the healpix = 13917
chunk = 2
number of galaxies in the full healpix = 148758
number of galaxies tageted in the healpix = 906
50516
71.71770739555359 (s)
****************************************************************
*                      SLURM Batch System                      *
*           IN2P3 Computing Centre, Villeurbanne FR            *
****************************************************************
Date: Fri Mar 22 16:55:58 CET 2024
Job informations can be found using these commands:
Accounting:
sacct -j 4817011
Efficiency:
seff 4817011
****************************************************************
